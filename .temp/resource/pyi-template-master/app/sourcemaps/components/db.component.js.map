{"version":3,"sources":["components/db.component.ts"],"names":[],"mappings":";;;;;;;;;;;AAAA,6BAAyD;AACzD,+DAA8E;AAC9E,+DAA4D;AAE5D,iCAAiC;AACjC,wBAAwB;AACxB,qBAAqB;AACrB,kBAAkB;AAClB,2GAA2G;AAC3G,aAAa;AACb,8GAA8G;AAC9G,SAAS;AACT,cAAc;AACd,mBAAmB;AACnB,0BAA0B;AAC1B,QAAQ;AACR,KAAK;AAGL,IAAa,WAAW,GAAxB,MAAa,WAAY,SAAQ,kBAA6B;IAO1D,YAAY,KAAuB;QAC/B,KAAK,CAAC,KAAK,CAAC,CAAC;QACb,IAAI,CAAC,EAAE,GAAG,IAAI,gCAAS,CAAC,KAAK,CAAC,CAAC;IACnC,CAAC;IAEM,QAAQ;QACX,OAAO,IAAI,CAAC,EAAE,CAAC;IACnB,CAAC;IAEM,KAAK,CAAC,KAAgB;QACzB,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;QAC3B,OAAO,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;IAChC,CAAC;CACJ,CAAA;AAjBG;IADC,eAAS;8BACK,iCAAe;0CAAC;AAHtB,WAAW;IADvB,eAAS;;GACG,WAAW,CAoBvB;AApBY,kCAAW","file":"../../components/db.component.js","sourcesContent":["import { Component, PYIComponent, autowired } from 'pyi';\nimport { Sequelize, SequelizeOptions, ModelCtor } from 'sequelize-typescript';\nimport { DBConfiguration } from '../config/database.config';\n\n// @Component<SequelizeOptions>({\n//     dialect: 'mysql',\n//     replication: {\n//         read: [\n//             { host: '127.0.0.1', username: 'root', password: 'yihq1105', port: 3306, database: 'test' },\n//         ],\n//         write: { host: '127.0.0.1', username: 'root', password: 'yihq1105', port: 3306, database: 'test' },\n//     },\n//     pool: {\n//         max: 20,\n//         idle: 60 * 1000\n//     }\n// })\n\n@Component\nexport class DBComponent extends PYIComponent<DBConfiguration> {\n\n    @autowired\n    public props!: DBConfiguration;\n\n    public db: Sequelize;\n\n    constructor(props: SequelizeOptions) {\n        super(props);\n        this.db = new Sequelize(props);\n    }\n\n    public instance() {\n        return this.db;\n    }\n\n    public table(model: ModelCtor): ModelCtor {\n        this.db.addModels([model]);\n        return this.db.model(model);\n    }\n}\n"]}